homeassistant:
  # Name of the location where Home Assistant is running
  name: !secret hass_name
  # Location required to calculate the time the sun rises and sets
  latitude: !secret my_latitude
  longitude: !secret my_longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 25
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Paris
  # Customization file
  customize: !include customize.yaml
  # Customization file
  packages: !include_dir_named packages


# Enables the frontend
frontend:
  # javascript_version: latest
  themes: !include_dir_merge_named themes/


zone:

  # - name: Work
  #   latitude: 32.8753367
  #   longitude: -117.2474053

  # This will override the default home zone
  - name: Home
    latitude: !secret my_latitude
    longitude: !secret my_longitude
    radius: 17
    icon: mdi:home

  - name: 1A Sophia
    latitude: 43.624068
    longitude: 7.060657
    radius: 200
    icon: mdi:worker

  - name: 1A Bel Air
    latitude: 43.647358
    longitude: 7.121510
    radius: 80
    icon: mdi:worker


notify:
  - name: ALL_MOBILES
    platform: group
    services:
      - service: mobile_app_jerome_s_iphone
      - service: mobile_app_corinnes_iphone

# Enables configuration UI
config:

mobile_app:

http:
  # api_password: !secret http_password
  ssl_certificate: !secret ssl_certificate
  ssl_key: !secret ssl_key
  base_url: !secret base_url


updater:
  include_used_components: true


logger:
  default: info
  logs:
    homeassistant.components.rflink: debug
    homeassistant.custom_components.rachio: debug
    aiohttp: error
    google_assistant: debug


system_health:


history:
  include:
    domains:
      - sensor
      - climate
  exclude:
    entities:
      - sensor.geocoded_location
      - sensor.geocoded_location_2


recorder:
  purge_keep_days: 5
  purge_interval: 1
  exclude:
    domains:
      - battery_alert


person:


# View all events in a logbook
logbook:
  exclude:
    entities:
      - light.lights_all
      - light.barentry_light
      - light.barwindow_light
      - light.stairs_light
      - binary_sensor.motion_living
      - binary_sensor.motion_bar
      - binary_sensor.motion_kitchen
      - binary_sensor.motion_home
      - automation.battery_sensor_from_attributes
      - automation.update_battery_status_group_members
      - automation.battery_notification_clear
      - automation.battery_notification
      - automation.battery_persistent_notification_clear
      - automation.autolight_monitor
      - automation.battery_persistent_notification
      - light.lights_all
      - automation.update_sensor_states_regularly
      - device_tracker.corinnes_iphone
      - device_tracker.jerome_s_iphone
      - sensor.geocoded_location
      - sensor.geocoded_location_2
    domains:
      - battery_alert
      - switch
      - group
  include:
    entities:
      - group.motion_living

 
# Track the sun
sun:


weather:
  - platform: darksky
    api_key: !secret dark_sky_key
    mode: daily


device_tracker:
  - platform: bbox
    track_new_devices: false
    # interval_seconds: 30
    consider_home: 0:05


hacs:
  token: !secret hacs_git_token
  # python_script: true
  # theme: true


# breaking_changes:


xiaomi_aqara:
  discovery_retry: 20
  gateways:
   - host: lumi-gateway-v3_miio56297828
     key: !secret mi_gateway_key
     mac: !secret mi_gateway_mac


vacuum:
  - platform: xiaomi_miio
    host: rockrobo
    # token: !secret AspiBot_token
    # token: 45435557645676645A4670493338696B
    token: 47507169667939796d7277326f6a446f
    name: AspiBot


ffmpeg:

camera:
  - platform: ffmpeg
    name: Xiaofang
    # input: -t 10 -rtsp_transport tcp -i rtsp://xiaofang/unicast
    input: -rtsp_transport tcp -i rtsp://xiaofang/unicast
    # input: -rtsp_transport tcp -i rtsp://xiaofang/unicast
    # input: -stimeout 600 -rtsp_transport udp -i rtsp://xiaofang/unicast
    extra_arguments: -an

# stream:


google_assistant:
  project_id: !secret google_project_id
  # api_key: !secret google_home_key
  # service_account: !include google-assistant.json
  service_account:
    private_key: "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDTq4ZtZ47rXwwd\nF2eOxO373wIlXyuCDd5/yVhgCFRLUtF7rVeOVn29gVNG3+1ShcoiZFnzzdVshOaJ\nPjaACkbHB6ia90iWQ1OB1G+RI2dP8ZmtYsHrdT2ZhaaSniDWy/3e9+eNkEqN+slb\nI+1LRKT9guPvgjxSQidde8BN2EqmVy29MevioyNAPZ7MA8eOM34eR/GIGPTRIiqK\n1KuHOJ2oo5mQIUkxfvfvk0d3eG8WFt1ml3cZTIczIIbAA8TUO0tJLcIOB9qJGQOJ\n8QTHbPcKQhW+1YLXurqZFsCHOW3ABbPgwH3kiKFE8L3kfJxssfL5zAKRLCZ1bTsV\nd8YhD7l5AgMBAAECggEARP1ceK8uqW+Wwqqcsa9lA9l5WRXuV9rOYOcOu2ork0tg\nhMeISJfPLuOGcYzNzL5XliMQIIM/ozmj7CqPV+dBj2BjJ3MewP8bqi7D2FHqO+e6\nl4UfQG+7jpy9oH8So//j9HbnjT/w1NrfIyoQDx7GCezN/wP7RjJSo0kQ8i5jklgy\n9fJZL8BCoRe9bO6FqHZsNbMltYwAIGr+WdKoqtAZJWJk4knIUBpRuPVAV7Jj8A5T\ndR+xJOuSOoM7943RofOUZMvCXY68NfVSVK5GQmIE0G9ZZ4btSq5fkXOCFEgVarpk\njgJPMuOrJwzL6PWxvJcGc1r5CEssWQb7T6mKFYqf+wKBgQDw/0nvEOJxl/UljiDe\nxPJguJLdWmfOdFJKLifoOJgR1NmIY6B6x1MuFk/FY9VBftzSTxvzCZp/DGqTyqpD\nzBCCttP5loAVLfk0MnKEBITUUD/oxDVYuZbTXPo/azaDCRUXtFERs5QClirw471e\nHhgDCJTphkn7OHGW5EeHCEYx1wKBgQDg2NsuJ0Ch6stBwBbVBgQZNQh1Lj2jjNPS\neVF5rFnAume5HSF3bMUoxT5WznJc1dBZidbM5zhrwV/NkYyd4DzHycW1rttQNXSx\nweY+W6epUNWf1hL/m0hse7UbCz4nsHDA49bdzFVRdmELqwTauPHbWRBbxr3lOJGS\nh+ls+rulLwKBgETltw1RlmtDNiJ2b49AXsqn+dSuc97iAmSSrXYGN/NhFo+Xa9mu\nAmm6lzOnRuBilF7LnwHsTO7lbdKyrdqUDGRSQGeqTxO/AO+bPIHhiNfp2VuCPH4R\nEL18Z06aKAtuHUmZk1OsMzRKGhyj/w9ZKyQy39+jNKNNj6vDt28zPl4hAoGBAKTw\n7/hvew5Me0aEbztd6mvDZ6zuevEbQdhIfuhO8phbJfO51u8Qr6E08IIld+d6Qhks\n8JHnnJAPjwPyHcFC2dOFxK9+0guI603q+8gK3HdsgQl7tPwlIX/TUAvCt5nN6SjW\n+qxCVOQpfw9cKXd57JIIR+PLa0pXsRJY+XekhzqpAoGAO18WiC1+tPE4gOay0Uhc\nN0nCyHDulmvg/0n2sdcE+tzmd861Ri4jR/27LWJSH1Zd3rctSnPUTyZZdlW7NduC\nRYZ+oHIUA88bCHD1XOH0ygCT2XI/RAp4zM1geJUBCAsK6nA50e1Dp07ppu6Y1cCZ\np6KvauIXyAQij7TvRTFKRXE=\n-----END PRIVATE KEY-----\n"
    client_email: "hass-594@home-assistant-da40a.iam.gserviceaccount.com"
  expose_by_default: false
  entity_config:
    light.light_living:
      # name: lumiere du salon
      expose: true
      room: Living Room
      aliases:
        - lumiere du salon
        - living room light
    light.light_bar:
      # name: lumiere du bar
      expose: true
      room: Living Room
      aliases:
        - lumiere du bar
        - bar light
    light.light_kitchen:
      # name: lumiere de la cuisine
      expose: true
      room: Living Room
      aliases:
        - lumiere de la cuisine
        - kitchen light
    lock.front_door:
      # name: porte d'entree
      expose: true
      aliases:
        - porte d'entree
        - front door
        - main door
        - porte
        - porte principale
      room: Living Room
    lock.polycontrol_danalock_v3_btze_locked:
      # name: porte de la buanderie
      expose: true
      room: Laundry
      aliases:
        - porte de la buanderie
        - back door
        - laundry door
        - porte de derri√®re
    cover.shelly_shutters_living:
      # name: volets roulants
      expose: true
      room: Living Room
      aliases:
        - volets roulants
        - shutters
    cover.sun_awning:
      # name: store
      expose: true
      room: Garden
      aliases:
        - store
        - awning
    light.light_lou_desk:
      expose: true
      room: Lou's bedroom
      aliases:
        - lumiere du bureau de Lou
        - Lou's desk light
    light.light_lou_ceiling:
      expose: true
      room: Lou's bedroom
      aliases:
        - lumiere principale de la chambre de Lou
        - Lou's ceiling light
        - Lou's bedroom main light
    light.light_bedroom:
      expose: true
      room: Bedroom
      aliases:
        - lumiere de la chambre
        - bedroom light
    climate.netatmo_living_room:
      expose: true
      room: Living Room
      aliases:
        - temperature
        - temperature interieure
        - temparature at home
        - temperature inside
    light.light_garage:
      expose: true
      room: Garage
      aliases:
        - lumiere du garage
        - garage light
    light.light_laundry:
      expose: true
      room: Laundry
      aliases:
        - lumiere de la buanderie
        - laundry light
    light.shelly_light_pool:
      expose: true
      room: Garden
      aliases:
        - lumiere de la piscine
        - pool light
    light.shelly_lights_trees:
      expose: true
      room: Garden
      aliases:
        - lumiere exterieure
        - lumiere des arbres
        - trees light
    sensor.netatmo_garden_temperature:
      expose: true
      room: Garden
      aliases:
        - temperature exterieure
        - temparature in the Garden
        - temperature outside
    scene.cosy:
      expose: true
      room: Living Room
      aliases:
        - ambiance cosy
    switch.movie_mode:
      expose: true
      room: Living Room
      aliases:
        - ambiance cinema
        - movie mode



lock:
  - platform: nuki
    host: !secret nuki_ip
    token: !secret nuki_token


zwave:
  usb_path: /dev/zwaveusbstick
  network_key: !secret zwave_key


rflink:
  port: /dev/rflink


mqtt:
  broker: localhost
  discovery: true
  discovery_prefix: homeassistant


# media_player:
#   - platform: samsungtv
#     host: 192.168.1.1
#     port: 8001
#     mac: d8:e0:e1:e0:c7:b7
#     name: "Samsung QE55Q7FAM"
  # - platform: cast
  #   host: 192.168.1.3

# media_player:
#   - platform: samsungtv_custom
#     host: 192.168.1.36
#     mac: d8:e0:e1:e0:c7:b7
#     port: 8002
#     sourcelist: '{"Bouygues TV": "KEY_HDMI1", "Blue Ray": "KEY_HDMI2", "Nintendo Switch": "KEY_HDMI3"}'
#     applist: "YouTube, Plex, Prime Video, Spotify"
#     protocol: ctl_qled

netatmo:
  client_id: !secret netatmo_id
  client_secret: !secret netatmo_secret
  # username: !secret netatmo_username
  # password: !secret netatmo_password


tuya:
  username: !secret tuya_username
  password: !secret tuya_password
  country_code: 33


# rachio:
#   api_key: !secret rachio_api_key
#   hass_url_override: !secret rachio_hass_url_override
# #   manual_run_mins: 3


shell_command:
  reboot_pi: 'sudo reboot'


input_boolean:
  night_mode:
    name: Night Mode
    initial: 'off'
    icon: mdi:sleep


binary_sensor:
  # - platform: rachio

  - platform: template
    sensors:
      motion_home:
        friendly_name: Motion
        device_class: motion
        entity_id: group.motion_home
        value_template: "{{ not(is_state('group.motion_home', 'off')) }}"
      vegetal_wall_watering:
        friendly_name: vegetal wall
        device_class: moisture
        entity_id: sensor.laundry_machines
        value_template: >-
          {%- set laundry_power = states('sensor.laundry_machines') | float -%}
          {{  (laundry_power > 10) and (laundry_power < 20) }}

  - platform: command_line
    name: vpn status
    device_class: connectivity
    scan_interval: 600
    command: /home/pi/scripts/check_vpn.sh


yeelight:
  devices:
    # yeelink-light-color1_miio56235794:
    #   name: barEntry_light
    #   use_music_mode: false
    #   model: color1
    # yeelink-light-color1_miio56367227:
    #   name: barWindow_light
    #   use_music_mode: false
    #   model: color1
    yeelink-light-color1_miio54993037:
      name: bedroom_light
      use_music_mode: false
      model: color1
    yeelink-light-ceiling10_mibtEB71:
      name: pendantEntry_light
      use_music_mode: false
      model: ceiling4
    yeelink-light-ceiling10_mibt7C35:
      name: pendantWindow_light
      use_music_mode: false
      model: ceiling4


# linky:
#   - username: !secret enedis_user
#     password: !secret enedis_password

shelly:
  discovery: True  #add all devices (default)
  igmp_fix: True
  mdns: True
  scan_interval: 30
  devices:  #configure devices
    - id: "008100"
      name: "shutters living"
      entity_id: shutters_living
    - id: "7ae030"
      name: "plug xiaomi gateway"
      entity_id: plug_xiaomi_gateway
    - id: "e631d5-1"
      name: "light@Pool"
      light_switch: true  #add this switch as a light
      entity_id: light_pool
    - id: "e631d5-2"
      name: "lights@Trees"
      light_switch: true  #add this switch as a light
      entity_id: lights_trees
    - id: "24CE1A"
      name: "light@Porch"
      light_switch: true  #add this switch as a light
      entity_id: light_porch

tts:
  - platform: google_translate

switch: !include switch.yaml
light: !include light.yaml
sensor: !include sensor.yaml
group: !include groups.yaml
scene: !include scenes.yaml
script: !include scripts.yaml
automation: !include automations.yaml
# automation: !include_dir_merge_list automation/

